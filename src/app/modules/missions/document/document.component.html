<div id="mainSection">
    <div class="card block">
        <div class="card-header pt-4 pb-4 entete">{{ titre }}</div>
        <div class="card-body">
            <form [formGroup]="forme" (ngSubmit)="onSubmit(forme.value)" *ngIf="forme" >
                <div class="">
                    <div class="">
                        <div class="form-group">
                            <div>
                                <div class="champs">
                                    <label for="titre" class="label">
                                        {{'document.table.title1' | translate}}
                                    </label>
                                    <input type="text" formControlName="titre" name="titre" id="titre"  placeholder="{{'document.table.title1' | translate}}"  class="form-control" required>
                                </div>
                                <div  *ngIf="submitted && f['titre'].errors"  class="alert alert-danger" >
                                    <div *ngIf="f['titre'].errors['required']">{{'document.form.text1' | translate}}</div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div>
                                <div class="champs">
                                    <label for="description" class="label" >
                                        {{"document.table.title2" | translate}}
                                    </label>
                                    <textarea type="textarea" formControlName="description" name="description" id="description" placeholder="{{'document.table.title2' | translate}}" class="form-control"  required></textarea>
                                </div>
                                <div  *ngIf="submitted && f['description'].errors"  class="alert alert-danger" >
                                    <div *ngIf="f['description'].errors['required']">{{'document.form.text2' | translate}}</div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="champs">
                                <label  for="missions" class="label">
                                    {{"document.table.title3" | translate}}
                                </label>
                                <div class="dropdown w-100">
                                    <button class="select dropdown-toggle btn" name="missions" id="missions" type="button" id="triggerId" data-toggle="dropdown" aria-haspopup="true"
                                            aria-expanded="false">
                                        {{'document.table.title5' | translate}}
                                    </button>
                                    <div class="dropdown-menu" aria-labelledby="triggerId">
                                        <label class="dropdown-item" for="missions" *ngFor="let missions of (mission$ | async) as mission let i=index">
                                            <input value=""  type="checkbox" formArrayName="_missions" [value]="missions.libelle" name="missions" id="missions" (change)="onCheckMissionChange($event)">
                                            {{missions.libelle}}
                                        </label>
                                    </div>
                                </div>  
                            </div>
                            <div  *ngIf="submitted && f['missions'].errors"  class="alert alert-danger" >
                                <div *ngIf="f['missions'].errors['required']">{{'document.form.text3' | translate}}</div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="champs">
                                <label  for="attributs" class="label">
                                    {{"document.table.title4" | translate}}
                                </label>
                                <div class="dropdown w-100">
                                <!-- Button trigger modal -->
                                    <button class="select btn" name="attributs" id="attributs" type="button" id="triggerId" data-toggle="modal" data-target="#modelId">
                                        {{'document.table.title6' | translate}}
                                    </button>
                                </div>
                                <!-- Modal -->
                                <div class="modal fade" id="modelId" tabindex="-1" role="dialog" aria-labelledby="modelTitleId" aria-hidden="true">
                                    <div class="modal-dialog modal-xl" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title">{{'document.table.title6' | translate}}</h5>
                                                <div class='card-hearder pt-3' >
                                                </div>
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                </button>
                                            </div>
                                            <div class="modal-body">
                                                <div class='card-hearder pt-3' >
                                                    <div class="d-flex align-items-center justify-content-end mr-4 tableTools">
                                                        <div class="form-inline mr-3">
                                                            <form class="example-form">
                                                                <mat-form-field class="example-full-width" appearance="fill">
                                                                  <mat-label class="searchBar">{{'patient.search-bar' | translate}}</mat-label>
                                                                  <input type="text" matInput aria-label="Rechercher" [formControl]="myControl" [matAutocomplete]="auto">
                                                                  <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">
                                                                    <mat-option *ngFor="let option of filteredOptions" [value]="option" (onSelectionChange)="rechercherListingAttribut(option)">
                                                                      {{option.titre}}
                                                                    </mat-option>
                                                                  </mat-autocomplete>
                                                                </mat-form-field>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div *ngFor="let attributs of (attrubut$ | async) as attrubut let i=index">
                                                    <label for="attributs">
                                                        <input value="" type="checkbox" formArrayName="_attributs" [value]="attributs.titre" name="attributs" id="attributs" (click)="getAttributId(attributs.id)" (change)="onCheckAttributChange($event)">
                                                        {{attributs.titre}}
                                                    </label>
                                                </div>
                                                <div class="result">
                                                    <div class="card" >
                                                        <div class="card-body p-0" id="tableBlock">
                                                            <div class='table-responsive w-100 m-0'>
                                                                <table class='table table-sm table-centered table-striped w-100' mat-table [dataSource]="dataSource" matSort (matSortChange)="announceSortChange($event)">
                                                                    <!-- titre Column -->
                                                                    <ng-container matColumnDef="titre">
                                                                        <th class="text-dark containHead" mat-header-cell *matHeaderCellDef mat-sort-header> {{'attributs.table.title1' | translate}} </th>
                                                                        <td class="text-dark containCell" mat-cell *matCellDef="let element"> {{element.titre}} </td>
                                                                    </ng-container>
                                                                    <!-- description Column -->
                                                                    <ng-container matColumnDef="description">
                                                                        <th class="text-dark containHead" mat-header-cell *matHeaderCellDef mat-sort-header> {{'attributs.table.title2' | translate}} </th>
                                                                        <td class="text-dark containCell" mat-cell *matCellDef="let element"> {{element.description}} </td>
                                                                    </ng-container>
                                                                    <!-- type Column -->
                                                                    <ng-container matColumnDef="type">
                                                                        <th class="text-dark containHead" mat-header-cell *matHeaderCellDef mat-sort-header> {{'attributs.table.title6' | translate}} </th>
                                                                        <td class="text-dark containCell" mat-cell *matCellDef="let element"> {{element.type}} </td>
                                                                    </ng-container>
                                                                    <!-- actions Column -->
                                                                    <ng-container matColumnDef="actions">
                                                                        <th class="text-dark containHead" mat-header-cell *matHeaderCellDef> {{"patient.table.title8" | translate}} </th>
                                                                        <td class="text-dark containCell" mat-cell *matCellDef="let element;  let i=index">
                                                                            <div id="actions">
                                                                                <label for="attributs">
                                                                                    <input type="checkbox" formControlName="attributs" [value]="element.titre" [checked]="true" name="attributs" id="attributs" (change)="retirerSelectionAttribut(i)">
                                                                                </label>
                                                                            </div>
                                                                        </td>
                                                                    </ng-container>
                                                                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                                                                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                                                                </table>
                                                                <mat-paginator style="background-color: rgba(126, 169, 126, 0.79);" [pageSizeOptions]="[5, 10, 20]"
                                                                               showFirstLastButtons
                                                                               aria-label="Select page of periodic elements">
                                                                </mat-paginator>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div  *ngIf="submitted && f['attributs'].errors"  class="alert alert-danger" >
                                <div *ngIf="f['attributs'].errors['required']">{{'document.form.text4' | translate}}</div>
                            </div>
                        </div>   
                        <!-- affichage list attributs selectiones -->
                        <div class="listAttr">
                            <ul class="nav d-flex align-items-center justify-content-start">
                                <li class="nav-item" *ngFor="let listeAttributs of dataSource.data">
                                    {{listeAttributs.titre}}
                                </li>                               
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="actionButton">
                    <button class="btn" routerLink="../list-documents">{{'lists.button2' | translate}}</button>
                    <button type="submit" class="btn">{{btnLibelle}}</button>
                </div>
            </form>
        </div>
        <!-- <p class="card w-100 pt-5">{{ forme.value | json }}</p>

        {{forme.value._attributs}} -->
    </div>
</div>