<div id="mainSection">
  <div class="card block">
    <div class="card-body p-0 m-0">
      <form [formGroup]="forme" (ngSubmit)="onSubmit(forme.value)" *ngIf="forme" g-reflect-forme="[object Object]" class="ng-valid ng-untouched ng-pristine ng-submitted">
        <div *ngIf="steps != 2 && steps != 3" class="w-100 pt-4 pb-4 entete">Nouvelle Pr√©conisation</div>
          <div *ngIf="steps==2" class="w-100 pt-4 pb-4 entete1" >Assigner aux Familles</div>
          <div *ngIf="steps==3" class="w-100 pt-4 pb-4 entete2">Assigner Une Ressource</div>

          <div class="w-100 mt-4 pt-0 pl-2 pr-2 pb-0">
            <div class="w-100">
              <div  *ngIf="steps==1" class="w-100">
                <div class="form-group">
                  <div>
                    <div class="champs">
                      <label for="libelle" class="label">
                        libelle
                      </label>
                      <input type="text" formControlName="libelle" name="libelle" id="libelle"  placeholder="{{'ressource.table.title1' | translate}}"  class="form-control" required>
                    </div>
                  </div>
              </div>

                <div class="form-group" id="eta">
                  <div>
                      <div class="champs">
                        <label for="etat" class="label" >
                          Etat
                        </label>
                        <input  type="checkbox" formControlName="etat" name="etat" class="form-control" id="etat" placeholder="" required checked>
                      </div>
                  </div>
                </div>

                <div class="form-group">
                  <div class="champs">
                    <label  for="type"  class="label" >
                      Type
                    </label>
                    <select class="form-control" formControlName="type">
                      <option class="label"*ngFor="let type of eltsPreco" ngvalue="type.id"  (click)="getPrecoMvtId(type.id)">
                      </option>
                    </select>
                  </div>
                </div>
            </div>
            </div>
          </div>

        <div *ngIf="steps == 2" class="form-group pt-0 pl-2 pr-2 pb-0">
          <div class="champs">
            <label for="famille" class="label">
            famille
            </label>
            <div class="dropdown w-100">
              <button class="select dropdown-toggle btn" name="famille" id="famille"  type="button" id="triggerId" data-toggle="dropdown" aria-haspopup="true"
                      aria-expanded="false">
                famille
              </button>
                <div class="dropdown-menu" aria-labelledby="triggerId" formArrayName="_familles">
                    <label class="dropdown-item" for="famille" *ngFor="let famille of (famille$ | async) as familles let i=index">
                        <input type="checkbox" required [value]="famille.id" name="familles" [id]="famille.id" (click)="getFamilleId(famille.id)">
                        {{famille.libelle}}
                    </label>
                </div>
              </div>
              </div>
            </div>

            <div  *ngIf="steps==3" class="form-group pt-0 pl-2 pr-2 pb-0">
              <div class="champs"  id="ressource">
                  <label  for="ressource"  class="label" id="label3">
                    Ressource
                  </label>
                  <mat-form-field class="example-full-width" appearance="fill">
                      <input  type="text" matInput [matAutocomplete]="auto" aria-label="ressource" formControlName="ressource" [formControl]="myControl" ng-reflect-name="ressource">
                      <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn" >
                      <mat-option *ngFor="let option of filteredOptions" [value]="option" (click)="getIdRessource(option.id)" (onSelectionChange)="rechercherListingRessource(option)">
                          {{option.libelle}}
                      </mat-option>
                      </mat-autocomplete>
                  </mat-form-field>
              </div>
            </div>

            <div *ngIf="steps == 2 || steps == 3" class="pt-0 pl-2 pr-2 pb-0">
              <div class="form-group">
                <div class="champs">
                    <label  for="quantiteMin"  class="label" >
                      Qte Min
                    </label>
                    <input type="number" formControlName="quantiteMin" name="quantiteMin" class="form-control" id="quantiteMin" placeholder="Entrer la quantite minimale" >
                </div>
              </div>

              <div class="form-group">
                  <div class="champs">
                      <label  for="quantiteMax"  class="label" >
                        Qte Max
                      </label>
                      <input type="number" formControlName="quantiteMax" name="quantiteMax" class="form-control" id="quantiteMax" placeholder="Entrer la quantite miximale" >
                  </div>
              </div>

              <div class="form-group">
                <div class="champs">
                  <label  for="montantMax"  class="label" >
                    Mt Min
                  </label>
                  <input type="number" formControlName="montantMax" name="montantMax" id="montantMax" placeholder="Entrer le montant minimal" class="form-control" >
                </div>
              </div>

              <div class="form-group">
                <div class="champs">
                    <label  for="montantMin"  class="label" >
                      Mt Max
                    </label>
                    <input type="number" formControlName="montantMin" name="montantMin" class="form-control" id="montantMin" placeholder="Entrer le montant miximal" >
                </div>
              </div>

              <div class="form-group">
                <div class="champs">
                  <label  for="fournisseur"  class="label" >
                    Fournisseur
                  </label>
                  <select class="form-control" formControlName="fournisseur"  name="fournisseur" id="fournisseur" ngModel >
                    <option class="label" *ngFor="let fournisseurs of  eltsPrecoMvtQte" [value]="fournisseurs.fournisseur">
                      {{fournisseurs.fournisseur}}
                    </option>
                  </select>
                </div>
            </div>
        </div>
        <div class="actionButton">
          <button class="btn" *ngIf="steps == 0" (click)="back()">Back</button>
          <button type="btn" class="btn" routerLink="../list-precomvts">Annuler</button>
          <button type="submit" class="btn" (click)="steps = 2; valPrecomvtqte(forme.value)">Famille</button>
          <button type="submit" class="btn" (click)="steps = 3; valPrecomvtqte(forme.value)">Ressource</button>
          <button type="submit" class="btn" *ngIf="steps != 4" (click)="steps = 4">Enregistrer</button>
        </div>
      </form>
    </div>
  </div>
  <div id="rigthSection" class="card">
    <div class="titleBlock" id="titleBlock">
      <h2>Etape</h2>
    </div>
    <div class="contentBlock">
      <div *ngFor="let elt of eltsPreco">
        <input type="button" id="" value="{{elt.libelle}}"><br/>
      </div>
    </div>
  </div>
</div>